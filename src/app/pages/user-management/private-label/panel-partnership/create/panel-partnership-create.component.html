<div class="page-layout simple fullwidth" fxLayout="column" fusePerfectScrollbar>
  <page-content-header [contentTitle]="'Panel Partnership'"></page-content-header>

  <div class="content p-24">
    <div class="ayo-main-wrapper mat-white-bg p-0" fxLayout="column" fusePerfectScrollbar>

      <mat-tab-group [selectedIndex]="selectedTab" (selectedTabChange)="onChangeTab($event)">
        <mat-tab label="Panel Partnership">

          <div class="ayo-middle" fxLayout="column">
            <form autocomplete="off" [formGroup]="createForm">
              <div class="pt-24 px-24" fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="60px"
                fxLayoutGap.lt-md="0px">
                <mat-form-field fxFlex="50%" class="is-light form-primary">
                  <mat-select formControlName="namaSupplier" placeholder="Pilih Supplier" id="namaSupplier" #singleSelect>
                    <ngx-mat-select-search [formControl]="filterSPL" [placeholderLabel]="'Cari Supplier...'"
                      [noEntriesFoundLabel]="'Tidak ada Supplier yang ditemukan'"></ngx-mat-select-search>
                    <mat-option *ngFor="let item of filteredSPL | async" [value]="item.id">
                      {{item.name}}
                    </mat-option>
                  </mat-select>
                  <mat-error
                    *ngIf="createForm.controls['namaSupplier'].hasError('required') && createForm.controls['namaSupplier'].touched">
                    Supplier harus diisi
                  </mat-error>
                </mat-form-field>

                <mat-form-field fxFlex="50%" class="is-light form-primary">
                  <mat-select formControlName="status" placeholder="Pilih Status">
                    <mat-option [value]="item.status" *ngFor="let item of supplierStatusList">{{item.name}}</mat-option>
                  </mat-select>
                  <!--<mat-error
                    *ngIf="createForm.controls['title'].hasError('required') && createForm.controls['title'].touched">
                    Judul Popup Notifikasi harus diisi
                  </mat-error>-->
                </mat-form-field>
              </div>

              <div class="px-24" fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="60px" fxLayoutGap.lt-md="0px">
                <mat-form-field fxFlex="50%" class="is-light form-primary">
                  <input matInput [matDatepicker]="tanggal_mulai_pendaftaran" (focus)="tanggal_mulai_pendaftaran.open()" formControlName="startDateRegistration"
                      placeholder="Tanggal Mulai Pendaftaran">
                    <mat-error
                      *ngIf="createForm.controls['startDateRegistration'].hasError('required') && createForm.controls['startDateRegistration'].touched">
                      Tanggal Mulai Pendaftaran harus diisi
                    </mat-error>
                    <mat-datepicker-toggle matSuffix [for]="tanggal_mulai_pendaftaran">
                      <mat-icon matDatepickerToggleIcon>date_range</mat-icon>
                    </mat-datepicker-toggle>
                    <mat-datepicker #tanggal_mulai_pendaftaran></mat-datepicker>
                </mat-form-field>
                <mat-form-field fxFlex="50%" class="is-light form-primary">
                  <input matInput [matDatepicker]="tanggal_berakhir_pendaftaran" (focus)="tanggal_berakhir_pendaftaran.open()" formControlName="endDateRegistration"
                      placeholder="Tanggal Berakhir Pendaftaran">
                    <mat-error
                      *ngIf="createForm.controls['endDateRegistration'].hasError('required') && createForm.controls['endDateRegistration'].touched">
                      Tanggal Berakhir Pendaftaran harus diisi
                    </mat-error>
                    <mat-datepicker-toggle matSuffix [for]="tanggal_berakhir_pendaftaran">
                      <mat-icon matDatepickerToggleIcon>date_range</mat-icon>
                    </mat-datepicker-toggle>
                    <mat-datepicker #tanggal_berakhir_pendaftaran></mat-datepicker>
                </mat-form-field>
              </div>

              <div class="px-24" fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="60px" fxLayoutGap.lt-md="0px">
                <mat-form-field fxFlex="50%" class="is-light form-primary">
                  <input matInput [matDatepicker]="tanggal_mulai_program" (focus)="tanggal_mulai_program.open()" formControlName="startDateProgram"
                      placeholder="Tanggal Mulai Program">
                    <mat-error
                      *ngIf="createForm.controls['startDateProgram'].hasError('required') && createForm.controls['startDateProgram'].touched">
                      Tanggal Mulai Program harus diisi
                    </mat-error>
                    <mat-datepicker-toggle matSuffix [for]="tanggal_mulai_program">
                      <mat-icon matDatepickerToggleIcon>date_range</mat-icon>
                    </mat-datepicker-toggle>
                    <mat-datepicker #tanggal_mulai_program></mat-datepicker>
                </mat-form-field>
                <mat-form-field fxFlex="50%" class="is-light form-primary">
                  <input matInput [matDatepicker]="tanggal_berakhir_program" (focus)="tanggal_berakhir_program.open()" formControlName="endDateProgram"
                      placeholder="Tanggal Berakhir Program">
                    <mat-error
                      *ngIf="createForm.controls['endDateProgram'].hasError('required') && createForm.controls['endDateProgram'].touched">
                      Tanggal Berakhir Program harus diisi
                    </mat-error>
                    <mat-datepicker-toggle matSuffix [for]="tanggal_berakhir_program">
                      <mat-icon matDatepickerToggleIcon>date_range</mat-icon>
                    </mat-datepicker-toggle>
                    <mat-datepicker #tanggal_berakhir_program></mat-datepicker>
                </mat-form-field>
              </div>

              <div class="px-24" fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="60px" fxLayoutGap.lt-md="0px">
                <mat-form-field fxFlex="47.5%" class="is-light form-primary">
                  <input matInput type="text" formControlName="title" placeholder="Judul Partnership">
                  <!--<mat-error
                    *ngIf="createForm.controls['positive_button'].hasError('required') && createForm.controls['positive_button'].touched">
                    Positif Button harus diisi
                  </mat-error>-->
                </mat-form-field>
              </div>

              <div class="pb-24 px-24">
                <div class="" fxLayout="row" fxLayoutAlign="start center">
                  <h3 class="">Detail Mechanism</h3>
                </div>
                <textarea [froalaEditor]="options" formControlName="detail" class="pb-4" fxFlex="100"></textarea>
                <!--<mat-error style="padding-top: 6px !important; font-size: .86em;"
                  *ngIf="createForm.controls['body'].hasError('required') && createForm.controls['body'].touched">
                  Detail Mechanism harus diisi
                </mat-error>-->
              </div>
            </form>
            <div class="pb-24 px-24">
              <form [formGroup]="formFilter" autoComplete="off">
                <div
                  fxLayout="row wrap"
                  fxLayoutAlign="space-between stretch"
                  fxLayout.lt-md="column"
                  class="pt-16"
                  fxLayoutGap="20px"
                  fxLayoutGap.lt-md="0px"
                  *ngIf="createForm.controls['geotree_checkbox'].value === true"
                >
                  <mat-form-field fxFlex="12%" class="is-light form-primary">
                    <mat-select placeholder="National" formControlName="national">
                      <mat-option
                        *ngFor="let item of listLevelArea"
                        [value]="item.id"
                        >{{ item.name }}</mat-option
                      >
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field fxFlex="12%" class="is-light form-primary">
                    <mat-select placeholder="Zone" formControlName="zone" multiple>
                      <mat-option
                        *ngFor="let item of filteringGeotree(list['zone'])"
                        [value]="item.id"
                        >{{
                          item.name === "all" ? "Semua
                        Zona" : item.code
                        }}</mat-option
                      >
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field fxFlex="12%" class="is-light form-primary">
                    <mat-select
                      placeholder="Regional"
                      formControlName="region"
                      multiple
                    >
                      <mat-option
                        *ngFor="let item of filteringGeotree(list['region'])"
                        [value]="item.id"
                        >{{
                          item.name === "all"
                            ? "Semua
                        Regional"
                            : item.code
                        }}</mat-option
                      >
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field fxFlex="12%" class="is-light form-primary">
                    <mat-select placeholder="Area" formControlName="area" multiple>
                      <mat-option
                        *ngFor="let item of filteringGeotree(list['area'])"
                        [value]="item.id"
                        >{{
                          item.name === "all" ? "Semua
                        Area" : item.code
                        }}</mat-option
                      >
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field fxFlex="12%" class="is-light form-primary">
                    <mat-select
                      placeholder="Salespoint"
                      formControlName="salespoint"
                      multiple
                    >
                      <mat-option
                        *ngFor="let item of filteringGeotree(list['salespoint'])"
                        [value]="item.id"
                        >{{
                          item.name === "all"
                            ? "Semua
                        Salespoint"
                            : item.code
                        }}</mat-option
                      >
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field fxFlex="12%" class="is-light form-primary">
                    <mat-select
                      placeholder="District"
                      formControlName="district"
                      multiple
                    >
                      <mat-option
                        *ngFor="let item of filteringGeotree(list['district'])"
                        [value]="item.id"
                        >{{
                          item.name === "all"
                            ? "Semua
                        District"
                            : item.code
                        }}</mat-option
                      >
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field fxFlex="12%" class="is-light form-primary">
                    <mat-select
                      placeholder="Territory"
                      formControlName="territory"
                      multiple
                    >
                      <mat-option
                        *ngFor="let item of filteringGeotree(list['territory'])"
                        [value]="item.id"
                        >{{
                          item.name === "all"
                            ? "Semua
                        Territori"
                            : item.code
                        }}</mat-option
                      >
                    </mat-select>
                  </mat-form-field>
                  <!--[R]-->
                  <mat-form-field fxFlex="31%" class="is-light form-primary">
                    <mat-select
                      placeholder="Retail Classification"
                      formControlName="retail_classification"
                      multiple
                    >
                      <mat-option
                        *ngFor="let item of filteringGeotree(list['territory'])"
                        [value]="item.id"
                        >{{
                          item.name === "all"
                            ? "Semua
                        Territori"
                            : item.code
                        }}</mat-option
                      >
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field fxFlex="31%" class="is-light form-primary">
                    <mat-select
                      placeholder="SRC Classification"
                      formControlName="src_classification"
                      multiple
                    >
                      <mat-option
                        *ngFor="let item of filteringGeotree(list['territory'])"
                        [value]="item.id"
                        >{{
                          item.name === "all"
                            ? "Semua
                        Territori"
                            : item.code
                        }}</mat-option
                      >
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field fxFlex="31%" class="is-light form-primary">
                    <mat-select
                      placeholder="SRC Type"
                      formControlName="src_type"
                      multiple
                    >
                      <mat-option
                        *ngFor="let item of filteringGeotree(list['territory'])"
                        [value]="item.id"
                        >{{
                          item.name === "all"
                            ? "Semua
                        Territori"
                            : item.code
                        }}</mat-option
                      >
                      <mat-option>Test</mat-option>
                    </mat-select>
                  </mat-form-field>
                  <!--[R]-->
                </div>
              </form>
            </div>

            <div class="pb-24 px-24">
              <div
                fxLayout="row wrap"
                fxLayout.lt-md="column"
                fxLayoutGap="20px"
                fxLayoutGap.lt-md="10px"
                fxLayoutAlign="end center"
                class="p-16 export"
              >
                <button
                  mat-raised-button
                  type="button"
                  class="is-danger"
                  (click)="importAudience()"
                >
                  <mat-icon>arrow_downward</mat-icon> Import XLS
                </button>
                <button
                  mat-raised-button
                  type="button"
                  class="is-danger"
                  (click)="exportAudience()"
                >
                  <mat-icon>arrow_upward</mat-icon> Export Template
                </button>
              </div>
              <mat-progress-bar
                [color]="'primary'"
                [mode]="'indeterminate'"
                *ngIf="loadingIndicator"
              ></mat-progress-bar>
              <ngx-datatable
                class="material"
                [rows]="rows"
                [columnMode]="'force'"
                [headerHeight]="48"
                [footerHeight]="56"
                [rowHeight]="'auto'"
                [reorderable]="reorderable"
                [selectionType]="'checkbox'"
                [selected] = "selected"
                [count]="pagination.total"
                [limit]="pagination.per_page"
                [externalPaging]="true"
                [selectAllRowsOnPage]="false"
                [externalSorting]="true"
                (page)="setPage($event)"
                [sorts]="[{ prop: 'name', dir: 'asc' }]"
                (select)="onSelect($event)"
                [rowIdentity]="getId"
                (sort)="onSort($event)"
                fusePerfectScrollbar
              >
                <ngx-datatable-column
                  [width]="68"
                  [canAutoResize]="false"
                  [sortable]="true"
                  [draggable]="false"
                  [resizeable]="false"
                  [headerCheckboxable]="true"
                >
                  <!-- <ng-template ngx-datatable-header-template let-value="value" let-allRowsSelected="allRowsSelected"
                    let-selectFn="selectFn">
                    <mat-checkbox [checked]="allRowsSelected" [disabled]="formAudience.get('type').value === 'pick-all'"
                      (change)="selectFn(!allRowsSelected)"></mat-checkbox>
                  </ng-template> -->

                  <ng-template
                    ngx-datatable-cell-template
                    let-value="value"
                    let-isSelected="isSelected"
                    let-onCheckboxChangeFn="onCheckboxChangeFn"
                  >
                    <mat-checkbox
                      [checked]="isSelected"
                      (change)="onCheckboxChangeFn($event)"
                    ></mat-checkbox>
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Penjual" prop="name"></ngx-datatable-column>
                <ngx-datatable-column
                  name="No Ponsel"
                  [width]="180"
                  prop="phone"
                  [sortable]="false"
                ></ngx-datatable-column>
                <ngx-datatable-column name="Kode" prop="code"></ngx-datatable-column>
                <ngx-datatable-column
                  name="Tipe"
                  prop="classification"
                ></ngx-datatable-column>
                <ngx-datatable-column
                  name="Retailer Classification"
                  prop="retail_classification"
                ></ngx-datatable-column>
                <ngx-datatable-column
                  name="SRC Classification"
                  prop="src_classification"
                ></ngx-datatable-column>
                <ngx-datatable-column
                  name="SRC Type"
                  prop="src_type"
                ></ngx-datatable-column>
                <ngx-datatable-column
                  name="Field Force"
                  prop="ff_name"
                  [sortable]="false"
                ></ngx-datatable-column>
                <ngx-datatable-column name="Daftar Ayo" prop="status">
                <ng-template
                  ngx-datatable-cell-template
                  let-row="row"
                  let-value="value"
                >
                  <span *ngIf="row.status === 'active' || row.status === 'inactive'"
                    >Yes</span
                  >
                  <span *ngIf="row.status === 'not-registered'">No</span>
                </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  name="Kode Divisi"
                  prop="division_code"
                  [sortable]="false"
                ></ngx-datatable-column>
                <ngx-datatable-column
                  name="Wilayah"
                  prop="region_code"
                  [sortable]="false"
                ></ngx-datatable-column>
                <ngx-datatable-column
                  name="Area"
                  prop="area_code"
                  [sortable]="false"
                ></ngx-datatable-column>
              </ngx-datatable>
              <div class="confirm pt-24 pb-24" fxLayout="row" fxLayoutGap="20px">
                <button
                mat-raised-button
                type="button"
                class="confirmation-button"
                (click)="submit()"
                fxFlex="20"
                >
                  SIMPAN
                </button>
              </div>
            </div>
            <a #downloadLink></a>
          </div>

        </mat-tab>
        <mat-tab label="Form Registration">
          
        </mat-tab>
        <mat-tab label="Design Banner">
          
        </mat-tab>
      </mat-tab-group>

    </div>
  </div>
</div>
