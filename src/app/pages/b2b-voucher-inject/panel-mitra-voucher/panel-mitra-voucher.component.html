<div class="ayo-middle p-24" fxLayout="column">
  <div>
    <div class='import-export-bar p-16' fxLayoutGap="20px" fxLayout="row wrap" fxLayoutAlign="end center">
      <div class="button-row">
        <button mat-flat-button style="width: 160px" color="white" (click)="importMitra()">
          <mat-icon>vertical_align_bottom</mat-icon> Import XLS
        </button>
      </div>
      <div class="button-row">
        <button mat-flat-button style="width: 160px" color="white" (click)="exportMitra()">
          <mat-icon>vertical_align_top</mat-icon> Export XLS
        </button>
      </div>
    </div>

    <form [formGroup]="formFilter" autoComplete="off">
      <div class="pl-16 pr-16 mt-8 bb" fxLayout="row wrap" fxLayoutAlign="space-between center" fxLayoutGap="20px">
        <mat-form-field fxLayout="row" fxLayoutAlign="center center">
          <mat-select placeholder="National" formControlName="national">
            <mat-option [value]="item.id" *ngFor="let item of listLevelArea">{{item.name}}</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field fxLayout="row" fxLayoutAlign="center center">
          <mat-select placeholder="Zone" formControlName="zone" multiple>
            <mat-option [value]="item.id" *ngFor="let item of filteringGeotree(list['zone'])">{{item.name === 'all' ?
              'Semua
              Zona' :
              item.code}}</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field fxLayout="row" fxLayoutAlign="center center">
          <mat-select placeholder="Regional" formControlName="region" multiple>
            <mat-option [value]="item.id" *ngFor="let item of filteringGeotree(list['region'])">{{item.name === 'all' ?
              'Semua
              Regional' :
              item.code}}</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field fxLayout="row" fxLayoutAlign="center center">
          <mat-select placeholder="Area" formControlName="area" multiple>
            <mat-option [value]="item.id" *ngFor="let item of filteringGeotree(list['area'])">{{item.name === 'all' ?
              'Semua
              Area' :
              item.code}}</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field fxLayout="row" fxLayoutAlign="center center">
          <mat-select placeholder="Salespoint" formControlName="salespoint" multiple>
            <mat-option [value]="item.id" *ngFor="let item of filteringGeotree(list['salespoint'])">{{item.name ===
              'all' ? 'Semua
              Salespoint' :
              item.code}}</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field fxLayout="row" fxLayoutAlign="center center">
          <mat-select placeholder="District" formControlName="district" multiple>
            <mat-option [value]="item.id" *ngFor="let item of filteringGeotree(list['district'])">{{item.name === 'all'
              ? 'Semua
              District' :
              item.code}}</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field fxLayout="row" fxLayoutAlign="center center">
          <mat-select placeholder="Territory" formControlName="territory" multiple>
            <mat-option [value]="item.id" *ngFor="let item of filteringGeotree(list['territory'])">{{item.name === 'all'
              ? 'Semua
              Territory' :
              item.code}}</mat-option>
          </mat-select>
        </mat-form-field>

        <div class="search-field" fxLayout="row" fxLayoutAlign="center center">
          <mat-icon>search</mat-icon>
          <mat-form-field class="is-light tab-search">
            <input matInput placeholder="Cari" (keyup)="keyUp.next($event.target.value)" autocomplete="off">
          </mat-form-field>
        </div>
      </div>
    </form>

    <ngx-datatable class="material" [rows]="rows" [loadingIndicator]="loadingIndicator" [columnMode]="'force'"
      [offset]="offsetPagination" [headerHeight]="48" [footerHeight]="56" [rowHeight]="'auto'" [scrollbarH]="true"
      [reorderable]="reorderable" [count]="pagination.total" [limit]="pagination.per_page" [externalPaging]="true"
      [externalSorting]="true" (page)="setPage($event)" (sort)="onSort($event)" [selected]="selected"
      [selectAllRowsOnPage]="false" [selectionType]="'checkbox'" (select)="onSelect($event)" [rowIdentity]="getId">

      <ngx-datatable-column [width]="68" [canAutoResize]="false" [sortable]="false">
        <!-- <ng-template ngx-datatable-header-template>
          <mat-checkbox [checked]="allRowsSelected" (change)="selectFn(!allRowsSelected);"></mat-checkbox>
        </ng-template> -->

        <ng-template ngx-datatable-cell-template let-value="value" let-isSelected="isSelected"
          let-onCheckboxChangeFn="onCheckboxChangeFn">
          <mat-checkbox [checked]="isSelected" (change)="onCheckboxChangeFn($event)" [disabled]="allRowsSelected"
            *ngIf="!allRowsSelected"></mat-checkbox>
          <mat-checkbox [checked]="true" [disabled]="allRowsSelected" *ngIf="allRowsSelected" class="mat-checkbox-all">
          </mat-checkbox>
        </ng-template>
      </ngx-datatable-column>

      <ngx-datatable-column name="Nama Toko" prop="name" [sortable]="true">
        <ng-template ngx-datatable-cell-template let-row="row" let-value="value">
          <span class="row-address">{{row.name || '-'}}</span>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column name="Kode Agen" prop="code" [sortable]="false">
        <ng-template ngx-datatable-cell-template let-row="row" let-value="value">
          <span class="row-address">{{row.code || '-'}}</span>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column name="Nama Pemilik" prop="owner" [sortable]="true">
        <ng-template ngx-datatable-cell-template let-row="row" let-value="value">
          <span class="row-address">{{row.owner || '-'}}</span>
        </ng-template>
      </ngx-datatable-column>
      <!-- <ngx-datatable-column name="Jumlah Voucher" prop="amount">
        <ng-template ngx-datatable-cell-template let-row="row" let-value="value">
          {{row.amount | rupiahFormaterWithoutRp}}
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column name="Nilai Voucher" prop="nominal">
        <ng-template ngx-datatable-cell-template let-row="row" let-value="value">
          {{row.nominal | rupiahFormater}}
        </ng-template>
      </ngx-datatable-column> -->

    </ngx-datatable>
    <div class="confirm p-24" fxLayout="row" fxLayoutAlign="center center" *ngIf="isEdit && extraPermission()">
      <button mat-raised-button type="button" class="confirmation-button" fxFlex="30" fxFlex.gt-xs="20"
        (click)="onSave()">
        SIMPAN
      </button>
    </div>
  </div>
</div>